<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>简历解析系统</title>
    <style>
		.container {
			display: flex;
			align-items: center; /* 垂直居中 */
			justify-content: center; /* 水平居中 */
			height: 100vh; /* 设置高度占满整个视口 */
		}

		.left {
			flex: 2; /* 占三分之二 */
			background-color: #ccc;
			height: 300px; /* 设置高度 */
			margin-right: 10px; /* 右边距为10像素 */
		}

		.right {
			flex: 1; /* 占三分之一 */
			background-color: #eee;
			height: 300px; /* 设置高度 */
		}
	</style>
    <link href="../public/css/web.css" rel="stylesheet" type="text/css"></link>
    <link rel="stylesheet" href="https://qidian.gtimg.com/lulu/edge/css/common/ui/Textarea.css">
</head>
<body>
    <header id="header">
        <h1>简历解析系统</h1>
        <nav id="navigation">
          <a href="#" class="active">首页</a>
          <a href="#">简历解析</a>
          <a href="#">批量解析</a>
        </nav>
      </header>
        <div class="container">
            <!-- <div id="preview" class="left"> -->
            <div id="preview-left">
                <div id="preview">
                    <label for="file-input">简历解析</label>
                    <div style="font-size: xx-small;">使用说明：粘贴简历文本至文本框或者提交简历文件，并点击提交按钮。</div>
                    <textarea class="ui-textarea" id="textarea"></textarea>   
                    <img id="image-preview" src="#" alt="" />
                    <div id="choose-file">
                    <label for="file-input">
                    </label>
                    <input type="file" id="file-input" multiple accept=".pdf,.jpg,.jpeg,.png" />
                    </div>
                        <button id="submit-btn" onclick="">开始解析</button>
                    </div>
                </div>
            </div>
            <div id="preview-right">
                <p>右边</p>
            </div>
        </div>
        


        <!-- <script src="../public/js/webhandle.js"></script> -->
        <script>
            const fileInput = document.getElementById("file-input");
            const submitBtn = document.getElementById("submit-btn");
            const previewImg = document.getElementById("image-preview");   
            
            var inputText
            var text = document.getElementById("textarea")

            text.addEventListener("input", function() {
                //实时监听文本框中数据 存入变量中
                inputText = text.value
                // 这里可以对inputText做进一步处理
                if (inputText) {
                    // console.log(inputText);
                    // var output =  parse(inputText)
                    console.log("文本处理...")
                    //是否有文本解析的api可以调用？？
                } 
            });

            fileInput.addEventListener("change", (event) => {
                
                const file = event.target.files[0];
                console.log(file);
                if (!file) {
                    return;
                }
                const reader = new FileReader();
                reader.onload = (event) => {
                    previewImg.src = event.target.result;
                };
                reader.readAsDataURL(file);
                reader.onload = function() {
                    const dataURL = reader.result;
                    const imgElement = document.createElement("file");
                    imgElement.src = dataURL;
                    document.body.appendChild(imgElement);
                }
            });

            submitBtn.addEventListener("click", (event) => {

                ///向后端提交文本
                console.log("----")
                console.log("text=", inputText)
                console.log(typeof inputText);

                const data = { text: inputText};

                fetch('/nlpHandler', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(data),
                })
                .then(response => {
                    let data = response.text()
                    console.log(data)
                    return data
                    // response.json()
                })
                .then(data => {
                    console.log(data);
                })
                .catch(error => {
                    console.error(error);
                });












                ///获取图片处理逻辑
                // const fileInput = document.querySelector('#file-input');
                // const file = fileInput.files[0];
                // console.log("file：",file)
                // if (file) {
                    
                // }
                // const reader = new FileReader();
                // reader.onload = (event) => {
                //     previewImg.src = event.target.result;
                // };
                // reader.readAsDataURL(file);
                // reader.onload = function() {
                //     const dataURL = reader.result;
                //     const imgElement = document.createElement("file");
                //     imgElement.src = dataURL;
                //     document.body.appendChild(imgElement);
                // }

                // const formData = new FormData();
                // formData.append('image', dataURL);
                // console.log(formData);

                
                

                ///提交图片
                //post时要把图片转为blob 后端再将blob转化成图片
                // fetch('/imgOcr', {
                //     method: 'POST',
                //     body: formData ,
                //     headers: {
                //     'Content-Type': 'multipart/form-data'
                //     }
                // })
                // .then(response => {
                //     let data = response.text()
                //     console.log(data)
                //     return data
                //     // response.json()
                // })
                // .then(data => {
                //     console.log(data);
                // })
                // .catch(error => {
                //     console.error(error);
                // });
            });
        </script>
    </body>
</html>